<!doctype html>
<html lang="ru" data-theme="dark">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport"
          content="width=device-width,initial-scale=1,viewport-fit=cover"/>
    <title>Amsterdam Countdown</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #0b1220;
            --fg: #eaf7ea;
            --muted: #9bb39b;
            --card: #0e1830;
            --accent: #20df6b;
            --accent-ink: #062412;
            --accent2: #ff7b00;
            --glass: rgba(15, 26, 47, .72);
            --stroke: rgba(255, 255, 255, .08);
            --ring: rgba(32, 223, 107, .45);
            --shadow: rgba(0, 0, 0, .45);
        }

        html[data-theme="light"] {
            --bg: #f6fff6;
            --fg: #0a1a0f;
            --muted: #496649;
            --card: #ecfff0;
            --accent: #0db36a;
            --accent-ink: #031a10;
            --accent2: #df5e00;
            --glass: rgba(236, 255, 240, .78);
            --stroke: rgba(0, 0, 0, .08);
            --ring: rgba(13, 179, 106, .35);
            --shadow: rgba(0, 0, 0, .12);
        }

        html, body {
            height: 100%
        }

        body {
            margin: 0;
            color: var(--fg);
            font: 16px/1.5 system-ui, -apple-system, Inter, Segoe UI, Roboto, sans-serif;
            background: var(--bg);
            background-image: radial-gradient(1100px 520px at 10% -10%, color-mix(in oklab, var(--bg), #123 25%) 0%, var(--bg) 60%),
            radial-gradient(900px 480px at 110% 110%, color-mix(in oklab, var(--bg), #223a66 35%) 0%, var(--bg) 58%);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
            /* UX: remove ugly highlight & accidental zoom on tap */
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        .wrap {
            max-width: 680px;
            margin: 0 auto;
            padding: 24px 16px 160px;
            position: relative;
            z-index: 2
        }

        header {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 14px
        }

        .logo {
            font-size: 26px;
            filter: drop-shadow(0 0 10px var(--ring))
        }

        h1 {
            margin: 0;
            font-size: 20px;
            letter-spacing: .3px
        }

        .sub {
            margin-top: 4px;
            font-size: 12px;
            color: var(--muted)
        }

        .card {
            background: var(--glass);
            border: 1px solid var(--stroke);
            border-radius: 18px;
            padding: 16px;
            backdrop-filter: blur(12px) saturate(120%);
            box-shadow: 0 10px 40px var(--shadow), inset 0 0 0 1px rgba(255, 255, 255, .02);
            animation: pop .35s ease;
        }

        @keyframes pop {
            from {
                transform: scale(.985);
                opacity: .0
            }
            to {
                transform: scale(1);
                opacity: 1
            }
        }

        .timer {
            display: grid;
            grid-template-columns:repeat(4, 1fr);
            gap: 12px;
            text-align: center;
        }

        .tbox {
            background: color-mix(in oklab, var(--card), #000 10%);
            border: 1px solid var(--stroke);
            border-radius: 14px;
            padding: 12px 10px;
            position: relative;
            overflow: hidden;
        }

        .tbox::after {
            content: "";
            position: absolute;
            inset: 0;
            pointer-events: none;
            background: radial-gradient(500px 90px at 50% -25%, color-mix(in oklab, var(--accent), transparent 75%), transparent 60%);
            opacity: .7;
        }

        .tval {
            font-size: 30px;
            font-weight: 900;
            letter-spacing: .5px;
            text-shadow: 0 0 12px color-mix(in oklab, var(--accent), transparent 70%)
        }

        .tcap {
            font-size: 10px;
            color: var(--muted);
            margin-top: 2px;
            letter-spacing: .4px
        }

        .date {
            margin: 12px 2px 4px;
            font-size: 13px;
            color: var(--muted)
        }

        .accent {
            color: var(--accent2);
            font-weight: 800;
            text-shadow: 0 0 8px color-mix(in oklab, var(--accent2), transparent 65%)
        }

        /* –ë–ª–æ–∫ –ø–ª–∞–Ω–∞ –ø–æ —Ç—Ä–∞–≤–µ */
        .bank {
            margin-top: 14px;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 10px;
            align-items: start;
        }

        .bank-head {
            grid-column: 1/-1;
            display: flex;
            gap: 8px;
            align-items: baseline;
            justify-content: space-between;
        }

        .badge {
            font-weight: 800;
            font-size: 13px;
            letter-spacing: .4px;
            padding: 8px 12px;
            border-radius: 999px;
            background: color-mix(in oklab, var(--card), #000 8%);
            border: 1px solid color-mix(in oklab, var(--accent), transparent 60%);
            box-shadow: inset 0 0 20px color-mix(in oklab, var(--accent), transparent 88%);
        }

        .help {
            font-size: 11px;
            color: var(--muted)
        }

        .actions {
            display: flex;
            gap: 10px;
            grid-column: 1/-1
        }

        .pill {
            border: none;
            padding: 12px 14px;
            border-radius: 14px;
            cursor: pointer;
            background: var(--accent);
            color: var(--accent-ink);
            font-weight: 900;
            letter-spacing: .3px;
            transition: transform .06s ease, filter .2s ease, box-shadow .2s ease;
            box-shadow: 0 6px 20px color-mix(in oklab, var(--accent), transparent 70%), inset 0 -2px 0 rgba(0, 0, 0, .15);
            /* UX: prevent double-tap zoom on iOS/Android */
            touch-action: manipulation;
        }

        .pill.ghost {
            background: color-mix(in oklab, var(--card), #000 6%);
            color: var(--fg);
            border: 1px solid color-mix(in oklab, var(--accent), transparent 60%);
            box-shadow: 0 6px 14px var(--shadow);
        }

        .pill:active {
            transform: translateY(1px) scale(.98)
        }

        .pill:hover {
            filter: brightness(1.06)
        }

        .pill:focus-visible {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px color-mix(in oklab, var(--accent), transparent 70%);
        }

        .pill.small {
            padding: 10px 12px
        }

        .grams {
            grid-column: 1/-1;
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 10px;
            background: color-mix(in oklab, var(--card), #000 10%);
            border: 1px solid var(--stroke);
            border-radius: 14px;
        }

        .gval {
            font-size: 28px;
            font-weight: 900;
            text-shadow: 0 0 10px color-mix(in oklab, var(--accent), transparent 75%)
        }

        .hint {
            margin-top: 6px;
            font-size: 11px;
            color: var(--muted);
            text-align: right
        }

        /* –ë–ª–æ–∫ —Ñ–∞–∫—Ç–æ–≤ –ø—Ä–æ –ê–º—Å—Ç–µ—Ä–¥–∞–º */
        .facts {
            margin-top: 18px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .facts-head {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 8px;
        }

        .facts-help {
            font-size: 11px;
            color: var(--muted);
        }

        .fact-card {
            padding: 12px 12px;
            border-radius: 14px;
            border: 1px solid var(--stroke);
            background: color-mix(in oklab, var(--card), #000 10%);
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, .02);
            font-size: 13px;
            line-height: 1.5;
        }

        .fact-label {
            font-weight: 700;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: .12em;
            color: var(--muted);
            margin-bottom: 4px;
        }

        .fact-text {
            font-size: 13px;
        }

        .skyline {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            height: 130px;
            pointer-events: none;
            opacity: .22;
            background: linear-gradient(180deg, transparent 0, transparent 92px, var(--accent2) 93px, var(--accent2) 96px, transparent 97px),
            repeating-linear-gradient(90deg, #0000 0 24px, color-mix(in oklab, #000, var(--bg)) 24px 26px);
            mask: radial-gradient(120px 60px at 8% 100%, #000 98%, #0000 100%),
            radial-gradient(140px 70px at 28% 100%, #000 98%, #0000 100%),
            radial-gradient(110px 55px at 48% 100%, #000 98%, #0000 100%),
            radial-gradient(150px 75px at 68% 100%, #000 98%, #0000 100%),
            radial-gradient(120px 60px at 88% 100%, #000 98%, #0000 100%);
            mask-composite: intersect;
        }

        .burst {
            position: fixed;
            pointer-events: none;
            z-index: 5;
            font-size: 18px;
            animation: fly 900ms ease-out forwards;
            text-shadow: 0 0 10px rgba(255, 255, 255, .35);
        }

        @keyframes fly {
            0% {
                transform: translate(var(--x, 0), var(--y, 0)) scale(.6);
                opacity: 0
            }
            10% {
                opacity: 1
            }
            100% {
                transform: translate(calc(var(--x, 0) * 1.8), calc(var(--y, 0) * 1.8 - 80px)) rotate(25deg) scale(1.25);
                opacity: 0
            }
        }

        .shake {
            animation: shake .3s ease
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0)
            }
            25% {
                transform: translateX(-2px)
            }
            75% {
                transform: translateX(2px)
            }
        }

        /* Respect prefers-reduced-motion: disable ‚Äúextra‚Äù animations */
        @media (prefers-reduced-motion: reduce) {
            .card,
            .burst,
            .shake {
                animation: none !important;
            }

            .pill {
                transition: none;
            }
        }

        @media (max-width: 360px) {
            .tval {
                font-size: 26px
            }

            .gval {
                font-size: 24px
            }
        }

        @media (prefers-color-scheme: light) {
            html:not([data-theme="dark"]) {
                color-scheme: light;
            }
        }

        .pill {
            border: none;
            padding: 12px 14px;
            border-radius: 14px;
            cursor: pointer;
            background: var(--accent);
            color: var(--accent-ink);
            font-weight: 900;
            letter-spacing: .3px;
            transition: transform .06s ease, filter .2s ease, box-shadow .2s ease;
            box-shadow: 0 6px 20px color-mix(in oklab, var(--accent), transparent 70%), inset 0 -2px 0 rgba(0, 0, 0, .15);
            touch-action: manipulation;
        }
        /* NEW: make anchor pills look/behave the same as buttons */
        a.pill {
            display: inline-block;
            text-decoration: none;
        }
    </style>
</head>
<body>
<div class="wrap">
    <header>
        <div class="logo" aria-hidden="true">üåø</div>
        <div>
            <h1>Amsterdam Countdown</h1>
            <div class="sub" id="subtitle">–î–æ –≤—ã–ª–µ—Ç–∞ ‚Äî –¥–µ—Ä–∂–∏–º —Ç–µ–º–ø</div>
        </div>
    </header>

    <div class="card" aria-label="–¢–∞–π–º–µ—Ä –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–æ–µ–∑–¥–∫–µ">
        <div class="timer" role="timer" aria-live="polite">
            <div class="tbox">
                <div class="tval" id="d">‚Äî</div>
                <div class="tcap">–¥–Ω–∏</div>
            </div>
            <div class="tbox">
                <div class="tval" id="h">‚Äî</div>
                <div class="tcap">—á–∞—Å—ã</div>
            </div>
            <div class="tbox">
                <div class="tval" id="m">‚Äî</div>
                <div class="tcap">–º–∏–Ω</div>
            </div>
            <div class="tbox">
                <div class="tval" id="s">‚Äî</div>
                <div class="tcap">—Å–µ–∫</div>
            </div>
        </div>

        <div class="date" aria-label="–î–∞—Ç–∞ –≤—ã–ª–µ—Ç–∞">
            ‚úàÔ∏è <span class="accent" title="–õ–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞">5 –¥–µ–∫–∞–±—Ä—è 2025, 12:00</span>
        </div>

        <!-- –õ–∏—á–Ω—ã–π –ø–ª–∞–Ω (–ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ) -->
        <div class="bank" aria-labelledby="planTitle" aria-describedby="planHelp">
            <div class="bank-head">
                <div id="planTitle" class="badge" title="–õ–∏—á–Ω—ã–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä –Ω–∞ –ø–æ–µ–∑–¥–∫—É">–õ–∏—á–Ω—ã–π –ø–ª–∞–Ω</div>
                <div id="planHelp" class="help">
                    —Å–∫–æ–ª—å–∫–æ <strong>–ø–ª–∞–Ω–∏—Ä—É–µ—à—å</strong> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–∑–Ω–∞—á–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ)
                </div>
            </div>

            <div class="actions" aria-label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–º">
                <button class="pill" id="incBtn" type="button" aria-label="–î–æ–±–∞–≤–∏—Ç—å 1 –≥—Ä–∞–º–º –∫ –ø–ª–∞–Ω—É">+1 –≥</button>
                <button class="pill ghost" id="decBtn" type="button" aria-label="–£–±—Ä–∞—Ç—å 1 –≥—Ä–∞–º–º –∏–∑ –ø–ª–∞–Ω–∞" hidden>
                    ‚àí1 –≥ —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å
                </button>
            </div>

            <div class="grams" aria-live="polite">
                <div class="gval" id="grams" aria-label="–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞–Ω–∞">0 –≥</div>
            </div>
        </div>

        <div class="hint" role="note">
            –î–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∏ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è ‚Äî —Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ. ü´¢
        </div>

        <div class="facts" aria-labelledby="hostelTitle">
            <div class="facts-head">
                <div class="badge" id="hostelTitle">–•–æ—Å—Ç–µ–ª</div>
                <div class="facts-help">–±—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ Google Maps</div>
            </div>

            <div class="actions" aria-label="–°—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Ä—Ç—ã">
                <a
                        class="pill"
                        href="https://maps.app.goo.gl/trCqtmrhjbaYZvCKA"
                        target="_blank"
                        rel="noopener noreferrer"
                        aria-label="–û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ö–æ—Å—Ç–µ–ª–∞ –≤ Google Maps"
                >–û—Ç–∫—Ä—ã—Ç—å –≤ Google Maps</a>
            </div>
        </div>

        <!-- –§–∞–∫—Ç—ã –æ –ø—Ä–∞–≤–∏–ª–∞—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ -->
        <div class="facts" aria-labelledby="factTitle" aria-describedby="factHelp">
            <div class="facts-head">
                <div class="badge" id="factTitle">–§–∞–∫—Ç—ã –æ –ø—Ä–∞–≤–∏–ª–∞—Ö</div>
                <div class="facts-help" id="factHelp">–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –æ –∫–æ—Ñ–µ—à–æ–ø–∞—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</div>
            </div>

            <button
                    class="pill small"
                    id="factBtn"
                    type="button"
                    aria-label="–ü–æ–∫–∞–∑–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∞–∫—Ç –æ –ø—Ä–∞–≤–∏–ª–∞—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –ê–º—Å—Ç–µ—Ä–¥–∞–º–µ"
            >
                –ù–æ–≤—ã–π —Ñ–∞–∫—Ç üìö
            </button>

            <div class="fact-card" id="factCard">
                <div class="fact-label">–ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–µ–∑–¥–∫–æ–π</div>
                <div class="fact-text" id="factText">
                    –ù–∞–∂–º–∏ ¬´–ù–æ–≤—ã–π —Ñ–∞–∫—Ç¬ª, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –∫–æ—Ä–æ—Ç–∫—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É –æ –º–µ—Å—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª–∞—Ö –∏ harm reduction üåø
                </div>
            </div>
        </div>
    </div>
</div>



<div class="skyline" aria-hidden="true"></div>

<script>
    // === Telegram theme integration ===
    (function applyTelegramTheme() {
        const tg = window.Telegram?.WebApp;
        if (!tg) return;
        tg.expand();
        const theme = (tg.colorScheme || 'light').toLowerCase();
        document.documentElement.setAttribute('data-theme', theme === 'dark' ? 'dark' : 'light');

        const p = tg.themeParams || {};
        const setVar = (name, val) => val && document.documentElement.style.setProperty(name, val);
        setVar('--accent', p.button_color);
        setVar('--accent2', p.link_color);
        setVar('--accent-ink', p.button_text_color);
        setVar('--muted', p.hint_color);
    })();

    // === Countdown ===
    const dEl = document.getElementById('d');
    const hEl = document.getElementById('h');
    const mEl = document.getElementById('m');
    const sEl = document.getElementById('s');
    const subEl = document.getElementById('subtitle');

    // NOTE: interpreted in user's local timezone
    const TARGET = new Date('2025-12-05T12:00:00');

    function updateTimer(diffMs) {
        if (diffMs <= 0) {
            dEl.textContent = '0';
            hEl.textContent = '00';
            mEl.textContent = '00';
            sEl.textContent = '00';
            subEl.textContent = '–ü–æ—Ä–∞ –≤–∑–ª–µ—Ç–∞—Ç—å! ‚úàÔ∏è';
            sparkBurst(window.innerWidth / 2, 40, ['‚ú®', 'üåø', 'üß°']);
            return false;
        }
        const totalSeconds = Math.floor(diffMs / 1000);
        const days = Math.floor(totalSeconds / 86400);
        const hours = Math.floor((totalSeconds % 86400) / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;

        dEl.textContent = days.toLocaleString('ru-RU');
        hEl.textContent = hours.toString().padStart(2, '0');
        mEl.textContent = minutes.toString().padStart(2, '0');
        sEl.textContent = seconds.toString().padStart(2, '0');
        return true;
    }

    const timerId = setInterval(() => {
        const diff = TARGET.getTime() - Date.now();
        if (!updateTimer(diff)) clearInterval(timerId);
    }, 1000);
    updateTimer(TARGET.getTime() - Date.now());

    // === –õ–∏—á–Ω—ã–π –ø–ª–∞–Ω (–≥—Ä–∞–º–º—ã) ===
    const LS_KEY = 'ams.plan.v1';
    const gramsEl = document.getElementById('grams');
    const inc = document.getElementById('incBtn');
    const dec = document.getElementById('decBtn');

    const funnyLines = [
        '–°–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞ –º–µ—Å—Ç–µ üßò',
        '–ú–∏–Ω—É—Å –≥—Ä–∞–º–º ‚Äî –ø–ª—é—Å —è—Å–Ω–æ—Å—Ç–∏ ‚ú®',
        '–ü–ª–∞–Ω –≥–∏–±–∫–∏–π, —Ç—ã ‚Äî –≥–ª–∞–≤–Ω—ã–π üòâ',
        '–û—Ä–≥–∞–Ω–∏–∑–º —Å–∫–∞–∂–µ—Ç —Å–ø–∞—Å–∏–±–æ üòå',
        '–í —Ç–µ–º–ø–µ, –Ω–æ –±–µ–∑ –ø–µ—Ä–µ–≥–∏–±–æ–≤ üíö'
    ];

    function readFromStorage() {
        try {
            const raw = localStorage.getItem(LS_KEY) || '0';
            const n = parseInt(raw, 10);
            return Number.isFinite(n) && n > 0 ? n : 0;
        } catch {
            return 0;
        }
    }

    let gramsValue = readFromStorage();

    function saveToStorage(value) {
        try {
            localStorage.setItem(LS_KEY, String(value));
        } catch {
            /* ignore */
        }
    }

    function renderGrams() {
        gramsEl.textContent = gramsValue.toLocaleString('ru-RU') + ' –≥';
        dec.hidden = gramsValue <= 0;
    }

    function haptic(type) {
        try {
            window.Telegram?.WebApp?.HapticFeedback?.impactOccurred(type || 'light');
        } catch { /* ignore */
        }
    }

    function sparkBurst(x, y, set) {
        const emojis = set || ['üåø', 'üí•', 'üü†', '‚ú®'];
        const n = 12;
        for (let i = 0; i < n; i += 1) {
            const e = document.createElement('div');
            e.className = 'burst';
            e.textContent = emojis[i % emojis.length];
            const angle = (Math.PI * 2 / n) * i + (Math.random() * 0.5 - 0.25);
            const dist = 60 + Math.random() * 40;
            const dx = Math.cos(angle) * dist;
            const dy = Math.sin(angle) * dist;
            e.style.left = x + 'px';
            e.style.top = y + 'px';
            e.style.setProperty('--x', dx + 'px');
            e.style.setProperty('--y', dy + 'px');
            document.body.appendChild(e);
            setTimeout(() => e.remove(), 900);
        }
    }

    function cursorPoint(ev) {
        if (ev.touches?.[0]) return {x: ev.touches[0].clientX, y: ev.touches[0].clientY};
        return {x: ev.clientX, y: ev.clientY};
    }

    function pulse(el) {
        el.style.transition = 'transform .12s ease, text-shadow .2s ease';
        el.style.transform = 'scale(1.06)';
        el.style.textShadow = '0 0 18px var(--ring)';
        setTimeout(() => {
            el.style.transform = 'scale(1)';
            el.style.textShadow = '0 0 10px color-mix(in oklab, var(--accent), transparent 75%)';
        }, 120);
    }

    function toastLine(text) {
        const e = document.createElement('div');
        e.className = 'badge';
        e.style.position = 'fixed';
        e.style.left = '50%';
        e.style.top = '12px';
        e.style.transform = 'translateX(-50%)';
        e.style.zIndex = '6';
        e.style.backdropFilter = 'blur(8px)';
        e.style.padding = '10px 14px';
        e.textContent = text;
        document.body.appendChild(e);
        setTimeout(() => {
            e.style.transition = 'opacity .25s ease, transform .25s ease';
            e.style.opacity = '0';
            e.style.transform = 'translateX(-50%) translateY(-6px)';
        }, 1200);
        setTimeout(() => e.remove(), 1600);
    }

    inc.addEventListener('click', (ev) => {
        gramsValue += 1;
        saveToStorage(gramsValue);
        renderGrams();
        haptic('medium');
        const {x, y} = cursorPoint(ev);
        sparkBurst(x, y, ['üåø', '‚ú®', 'üß°']);
        pulse(gramsEl);
    });

    dec.addEventListener('click', (ev) => {
        if (gramsValue <= 0) return;
        gramsValue -= 1;
        saveToStorage(gramsValue);
        renderGrams();
        haptic('light');
        const {x, y} = cursorPoint(ev);
        sparkBurst(x, y, ['üßò', '‚ú®', 'ü•¶']);
        pulse(gramsEl);
        const msg = funnyLines[Math.floor(Math.random() * funnyLines.length)];
        toastLine(msg);
    });

    renderGrams();

    // === –§–∞–∫—Ç—ã –æ –ø—Ä–∞–≤–∏–ª–∞—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ===
    const FACTS = [
        '–í —Å—Ç–∞—Ä–æ–º —Ü–µ–Ω—Ç—Ä–µ/Red Light District –Ω–µ–ª—å–∑—è –∫—É—Ä–∏—Ç—å –∫–∞–Ω–Ω–∞–±–∏—Å –Ω–∞ —É–ª–∏—Ü–µ ‚Äî —à—Ç—Ä–∞—Ñ –æ–∫–æ–ª–æ ‚Ç¨100. –ö—É—Ä–∏—Ç—å –º–æ–∂–Ω–æ –≤–Ω—É—Ç—Ä–∏ –∏ –Ω–∞ —Ç–µ—Ä—Ä–∞—Å–∞—Ö –∫–æ—Ñ–µ—à–æ–ø–æ–≤. üö≠',
        '–ö–æ—Ñ–µ—à–æ–ø –ø—Ä–æ–¥–∞—Å—Ç –Ω–µ –±–æ–ª—å—à–µ 5 –≥ –∑–∞ —Ä–∞–∑ –æ–¥–Ω–æ–º—É —á–µ–ª–æ–≤–µ–∫—É. –†–µ–∫–ª–∞–º–∞ –∫–∞–Ω–Ω–∞–±–∏—Å–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–∞. ‚öñÔ∏è',
        '–ö–æ—Ñ–µ—à–æ–ø—ã –Ω–µ –ø—Ä–æ–¥–∞—é—Ç –∞–ª–∫–æ–≥–æ–ª—å, –∞ –±–∞—Ä—ã –Ω–µ –ø—Ä–æ–¥–∞—é—Ç –∫–∞–Ω–Ω–∞–±–∏—Å ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–≥–æ–µ. üö´üçª',
        'Spacecake –¥–µ–π—Å—Ç–≤—É–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ (–¥–æ —á–∞—Å–∞) –∏ –º–æ–∂–µ—Ç –Ω–∞–∫—Ä—ã—Ç—å —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –¥–∂–æ–π–Ω—Ç ‚Äî –Ω–∞—á–∏–Ω–∞–π —Å –º–∞–ª–æ–≥–æ. üç∞üî•',
        'Heineken Experience ‚Äî –º—É–∑–µ–π-–±—Ä—é-—Ç—É—Ä—ã –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π –ø–∏–≤–æ–≤–∞—Ä–Ω–µ –≤ —Ü–µ–Ω—Ç—Ä–µ –ê–º—Å—Ç–µ—Ä–¥–∞–º–∞. üç∫',
        '–ü–∏–≤–æ Amstel –Ω–∞–∑–≤–∞–Ω–æ –≤ —á–µ—Å—Ç—å —Ä–µ–∫–∏ –ê–º—Å—Ç–µ–ª, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –ø–æ—à—ë–ª –∏ –ê–º—Å—Ç–µ—Ä–¥–∞–º. üåä',
        '–î–æ–º–∞ —Ç–µ—Ä–ø—è—Ç –¥–æ 5 –≥ –∏ (—Ñ–æ—Ä–º–∞–ª—å–Ω–æ –Ω–µ–∑–∞–∫–æ–Ω–Ω—ã–µ) –¥–æ 5 —Ä–∞—Å—Ç–µ–Ω–∏–π ‚Äî –º–æ–≥—É—Ç –∏–∑—ä—è—Ç—å, –Ω–æ –æ–±—ã—á–Ω–æ –±–µ–∑ —É–≥–æ–ª–æ–≤–∫–∏. üè†üåø',
        '¬´–ì—Ä–∏–±—ã¬ª –∑–∞–ø—Ä–µ—â–µ–Ω—ã —Å 2008 –≥–æ–¥–∞, –Ω–æ –º–∞–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä—é—Ñ–µ–ª–∏ (sclerotia) –ª–µ–≥–∞–ª—å–Ω—ã –∏ –ø—Ä–æ–¥–∞—é—Ç—Å—è –≤ smartshop. üß†',
        '–í –≥–æ—Ä–æ–¥–µ ~165 –∫–æ—Ñ–µ—à–æ–ø–æ–≤ ‚Äî –º–Ω–æ–≥–æ, –Ω–æ –≤—Å–µ –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞–º. üåø',
        '–ê–ª–∫–æ–≥–æ–ª—å –∏ —Ç—Ä–∞–≤–∞ –≤–º–µ—Å—Ç–µ —É—Å–∏–ª–∏–≤–∞—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ ‚Äî –±–µ—Ä–µ–≥–∏ –∑–∞–≤—Ç—Ä–∞. üòµ‚Äçüí´',
        '–ï—Å–ª–∏ –ø–µ—Ä–µ–±–æ—Ä—â–∏–ª —Å–æ spacecake ‚Äî —Å—è–¥—å, –≤–æ–¥–∞, –ø–µ—Ä–µ–∫—É—Å –∏ –≤—Ä–µ–º—è. –ü–∞–Ω–∏–∫–∞ –ø—Ä–æ–π–¥—ë—Ç. üíß',
        '–ü–æ–ª–∏—Ü–∏—è –æ–±—ã—á–Ω–æ —Å–ø–æ–∫–æ–π–Ω–∞, –µ—Å–ª–∏ —Ç—ã –≤–µ–∂–ª–∏–≤ –∏ –Ω–µ –º–µ—à–∞–µ—à—å –¥—Ä—É–≥–∏–º. ü§ù',
        '–ú–Ω–æ–≥–∏–µ –∫–æ—Ñ–µ—à–æ–ø—ã –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –æ–∫–æ–ª–æ –ø–æ–ª—É–Ω–æ—á–∏‚Äì01:00 ‚Äî –ø–ª–∞–Ω–∏—Ä—É–π –∑–∞—Ä–∞–Ω–µ–µ. üåô',
        '–í —Ü–µ–Ω—Ç—Ä–µ —Ä–∞—Å–ø–∏–≤–∞—Ç—å –∞–ª–∫–æ–≥–æ–ª—å –Ω–∞ —É–ª–∏—Ü–µ –Ω–µ–ª—å–∑—è ‚Äî –ø–µ–π –≤–Ω—É—Ç—Ä–∏ –∏–ª–∏ –Ω–∞ —Ç–µ—Ä—Ä–∞—Å–µ. üö∑ü•Ç',
        '–í–æ–∑—Ä–∞—Å—Ç –¥–ª—è –∞–ª–∫–æ–≥–æ–ª—è ‚Äî 18+. –ü–∞—Å–ø–æ—Ä—Ç –º–æ–≥—É—Ç —Å–ø—Ä–æ—Å–∏—Ç—å –∏ –≤ –±–∞—Ä–µ, –∏ –≤ –∫–æ—Ñ–µ—à–æ–ø–µ. ü™™',
        '–°—ã—Ä + –ø–∏–≤–æ + –ª—ë–≥–∫–∏–π –∫–∞–π—Ñ = –Ω–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∞–º—Å—Ç–µ—Ä–¥–∞–º—Å–∫–∏–π —Ç—Ä–∏–∞—Ç–ª–æ–Ω. üßÄüç∫üåø',
        '–ú–Ω–æ–≥–∏–µ –ø—Ä–µ—Ä–æ–ª–ª—ã ‚Äî —Å —Ç–∞–±–∞–∫–æ–º. –ü—Ä–æ—Å–∏ ‚Äúpure‚Äù, –∏ –ø–æ–º–Ω–∏: —Ç–∞–±–∞–∫ –≤–Ω—É—Ç—Ä–∏ –ø–æ–º–µ—â–µ–Ω–∏–π –∑–∞–ø—Ä–µ—â—ë–Ω. üö¨‚ùå',
        '–ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ—Å–∏—Ç—å —Å–æ—Ä—Ç–∞ —Å –Ω–∏–∑–∫–∏–º THC –∏–ª–∏ CBD-–¥–æ–º–∏–Ω–∞–Ω—Ç–Ω—ã–µ ‚Äî –º—è–≥—á–µ –∏ –±–µ–∑ –ø–∞—Ä–∞–Ω–æ–π–∏. üòå',
        '–ì–æ–ª–ª–∞–Ω–¥—Å–∫–∏–π jenever ‚Äî ¬´–¥–µ–¥—É—à–∫–∞ –¥–∂–∏–Ω–∞¬ª, –∫—Ä–µ–ø–∫–∏–π –∏ –∞—Ä–æ–º–∞—Ç–Ω—ã–π. ü•É',
        '–ï—Å—Ç—å –±–∞—Ä—ã —Å –ø–∏–≤–æ–º 10%+ ‚Äî –≤–∫—É—Å–Ω–æ, –Ω–æ —Ö–∏—Ç—Ä–æ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ç—Ä–∞. üòµ‚Äçüç∫',
        'Icebar ‚Äî –±–∞—Ä –∏–∑–æ –ª—å–¥–∞: —Å—Ç–µ–Ω—ã, —Å—Ç–æ–π–∫–∞ –∏ –¥–∞–∂–µ –±–æ–∫–∞–ª—ã. ‚ùÑÔ∏èüç∏',
        '–í —Ü–µ–Ω—Ç—Ä–µ –ª—É—á—à–µ –Ω–µ —Å–∫—Ä—É—á–∏–≤–∞—Ç—å –∏ –Ω–µ –∫—É—Ä–∏—Ç—å –Ω–∞ —É–ª–∏—Ü–µ ‚Äî –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ public use –∏ –≥—Ä–æ–∑–∏—Ç —à—Ç—Ä–∞—Ñ–æ–º. üö®',
        '–ö–∞–Ω–∞–ª—ã, –∫–æ—Ñ–µ –∏ –ª—ë–≥–∫–∏–π —á–∏–ª–ª ‚Äî —Ñ–æ—Ä–º—É–ª–∞ –∏–¥–µ–∞–ª—å–Ω—ã—Ö –≤—ã—Ö–æ–¥–Ω—ã—Ö. ‚òïüåøüö≤',
        '–ö–æ—Ñ–µ—à–æ–ø—ã –¥–∞–ª—å—à–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –æ–±—ã—á–Ω–æ —Å–ø–æ–∫–æ–π–Ω–µ–µ –∏ –∏–Ω–æ–≥–¥–∞ –¥–µ—à–µ–≤–ª–µ. üèôÔ∏è',
        '–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Ñ–µ—à–æ–ø—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–Ω—ã–µ ‚Äî –ø—Ä–æ–≤–µ—Ä—å –∑–∞—Ä–∞–Ω–µ–µ. üí∂',
        '–°–≤–æ–±–æ–¥–∞ —Ç—É—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ —É–≤–∞–∂–∞–µ—à—å –ø—Ä–∞–≤–∏–ª–∞ ‚Äî —Ç–æ–≥–¥–∞ –æ—Ç–¥—ã—Ö –ø—Ä–æ–π–¥—ë—Ç –≥–ª–∞–¥–∫–æ. ‚úÖ',
        '–ê–Ω—Ç–∏–¥–æ—Ç –æ—Ç –ø–∞—Ä–∞–Ω–æ–π–∏: –ø—Ä–æ–≥—É–ª–∫–∞ –≤–¥–æ–ª—å –∫–∞–Ω–∞–ª–æ–≤ –∏ —Å–≤–µ–∂–∏–π stroopwafel. üßáüåâ'
    ];

    const factBtn = document.getElementById('factBtn');
    const factTextEl = document.getElementById('factText');
    let lastFactIndex = -1;

    function getRandomFact() {
        if (!FACTS.length) return '';
        if (FACTS.length === 1) return FACTS[0];
        let idx;
        do {
            idx = Math.floor(Math.random() * FACTS.length);
        } while (idx === lastFactIndex);
        lastFactIndex = idx;
        return FACTS[idx];
    }

    if (factBtn && factTextEl) {
        factBtn.addEventListener('click', (ev) => {
            const fact = getRandomFact();
            if (!fact) return;
            factTextEl.textContent = fact;
            haptic('light');
            const {x, y} = cursorPoint(ev);
            sparkBurst(x, y, ['üìö', 'üåø', '‚ú®']);
            factTextEl.classList.add('shake');
            setTimeout(() => factTextEl.classList.remove('shake'), 300);
        });
    }

    document.addEventListener('click', (e) => {
        const pillLink = e.target.closest('a.pill');
        if (pillLink) {
            haptic('light');
        }
    });
</script>
</body>
</html>